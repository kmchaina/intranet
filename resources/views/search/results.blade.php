@extends('layouts.dashboard') @section('title', 'Search Results') @section('content') <div class="space-y-6"> <x-breadcrumbs :items="[[ 'label' => 'Dashboard', 'href' => route('dashboard') ], [ 'label' => 'Search' ]]" /> <!-- Search Header --> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"> <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"> <div> <h1 class="text-2xl font-bold text-gray-900 Search Results </h1> @if($query) <p class="text-gray-600 mt-1"> Results for "<span class="font-semibold">{{ $query }}</span>" </p> @endif </div> </div> </div> <!-- Search Form --> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"> <form method="GET" action="{{ route('search') }}" class="space-y-4"> <div class="flex flex-col lg:flex-row gap-4"> <!-- Search Input --> <div class="flex-1"> <div class="relative"> <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"> <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /> </svg> </div> <input type="text" name="q" value="{{ $query }}" placeholder="Search across all content..." class="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900 placeholder-gray-500 id="globalSearchInput" > </div> </div> <!-- Content Type Filter --> <div class="lg:w-48"> <select name="type" class="block w-full py-2.5 px-3 border border-gray-300 bg-white rounded-lg focus:ring-blue-500 focus:border-blue-500 text-gray-900 <option value="all" {{ $type === 'all' ? 'selected' : '' }}>All Content</option> <option value="announcements" {{ $type === 'announcements' ? 'selected' : '' }}>Announcements</option> <option value="news" {{ $type === 'news' ? 'selected' : '' }}>News</option> <option value="documents" {{ $type === 'documents' ? 'selected' : '' }}>Documents</option> <option value="users" {{ $type === 'users' ? 'selected' : '' }}>Users</option> </select> </div> <!-- Search Button --> <button type="submit" class="px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors"> Search </button> </div> </form> </div> @if($query && !empty($results)) <!-- Search Results --> @if($type === 'all') <!-- Show all types with counts --> @foreach($results as $contentType => $items) @if($items && $items->count() > 0) <div class="bg-white rounded-lg shadow-sm border border-gray-200 <div class="px-6 py-4 border-b border-gray-200 <div class="flex items-center justify-between"> <h2 class="text-lg font-semibold text-gray-900 capitalize"> {{ $contentType }} ({{ $items->count() }}) </h2> <a href="{{ route('search', ['q' => $query, 'type' => $contentType]) }}" class="text-blue-600 hover:text-blue-800 text-sm font-medium"> View All </a> </div> </div> <div class="p-6"> @include('search.partials.' . $contentType, ['items' => $items]) </div> </div> @endif @endforeach @else <!-- Show specific type results --> @php $items = $results[$type] ?? collect(); @endphp @if($items && $items->count() > 0) <div class="bg-white rounded-lg shadow-sm border border-gray-200 <div class="px-6 py-4 border-b border-gray-200 <h2 class="text-lg font-semibold text-gray-900 capitalize"> {{ $type }} Results ({{ $items->total() ?? $items->count() }}) </h2> </div> <div class="p-6"> @include('search.partials.' . $type, ['items' => $items]) @if(method_exists($items, 'links')) <div class="mt-6"> {{ $items->appends(['q' => $query, 'type' => $type])->links() }} </div> @endif </div> </div> @endif @endif @if(collect($results)->flatten()->isEmpty()) <!-- No Results Found --> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"> <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /> </svg> <h3 class="mt-4 text-lg font-medium text-gray-900 results found</h3> <p class="mt-2 text-gray-600 We couldn't find any content matching "<span class="font-semibold">{{ $query }}</span>". </p> <div class="mt-6"> <p class="text-sm text-gray-500 <ul class="mt-2 text-sm text-gray-500 space-y-1"> <li>• Checking your spelling</li> <li>• Using different keywords</li> <li>• Searching in a specific content type</li> <li>• Using shorter, more general terms</li> </ul> </div> </div> @endif @elseif($query) <!-- Empty query with search term --> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"> <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /> </svg> <h3 class="mt-4 text-lg font-medium text-gray-900 searching</h3> <p class="mt-2 text-gray-600 Enter a search term to find announcements, news, documents, and users. </p> </div> @else <!-- Welcome message --> <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"> <svg class="mx-auto h-12 w-12 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /> </svg> <h3 class="mt-4 text-lg font-medium text-gray-900 Search</h3> <p class="mt-2 text-gray-600 Search across all announcements, news, documents, and users in one place. </p> </div> @endif </div> @push('scripts') <script> // Auto-suggest functionality let searchTimeout; const searchInput = document.getElementById('globalSearchInput'); const suggestionsContainer = document.createElement('div'); // Style the suggestions container suggestionsContainer.className = 'absolute z-10 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-60 overflow-auto hidden'; // Insert suggestions container after search input searchInput.parentNode.appendChild(suggestionsContainer); searchInput.addEventListener('input', function() { const query = this.value.trim(); clearTimeout(searchTimeout); if (query.length < 2) { suggestionsContainer.classList.add('hidden'); return; } searchTimeout = setTimeout(() => { fetch(`{{ route('search.suggest') }}?q=${encodeURIComponent(query)}`) .then(response => response.json()) .then(suggestions => { displaySuggestions(suggestions); }) .catch(error => { console.error('Search suggestions error:', error); }); }, 300); }); function displaySuggestions(suggestions) { if (suggestions.length === 0) { suggestionsContainer.classList.add('hidden'); return; } suggestionsContainer.innerHTML = suggestions.map(suggestion => `<div class="px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200 last:border-b-0" onclick="selectSuggestion('${suggestion.text.replace(/'/g, "\\'")}')"> <div class="flex items-center"> <span class="text-xs px-2 py-1 rounded-full ${getSuggestionTypeColor(suggestion.type)} mr-3"> ${suggestion.type} </span> <span class="text-gray-900 </div> </div>` ).join(''); suggestionsContainer.classList.remove('hidden'); } function getSuggestionTypeColor(type) { const colors = { 'announcement': 'bg-blue-100 text-blue-800 'news': 'bg-green-100 text-green-800 'document': 'bg-purple-100 text-purple-800 }; return colors[type] || 'bg-gray-100 text-gray-800 } function selectSuggestion(text) { searchInput.value = text; suggestionsContainer.classList.add('hidden'); searchInput.form.submit(); } // Hide suggestions when clicking outside document.addEventListener('click', function(e) { if (!searchInput.contains(e.target) && !suggestionsContainer.contains(e.target)) { suggestionsContainer.classList.add('hidden'); } }); </script> @endpush @endsection
